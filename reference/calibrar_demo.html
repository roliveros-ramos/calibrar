<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Demos for the calibrar package — calibrar_demo • calibrar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demos for the calibrar package — calibrar_demo"><meta name="description" content="Creates demo files able to be processed for a full calibration using
the calibrar package"><meta property="og:description" content="Creates demo files able to be processed for a full calibration using
the calibrar package"><meta property="og:image" content="https://roliveros-ramos.github.io/calibrar/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">calibrar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9008</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/calibrar.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v02-parameter_estimation.html">Using the `calibrate()` function for parameter estimation</a></li>
    <li><a class="dropdown-item" href="../articles/v03-parameter_estimation_ODE.html">Parameter estimation for ODE systems</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/roliveros-ramos/calibrar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Demos for the calibrar package</h1>
      <small class="dont-index">Source: <a href="https://github.com/roliveros-ramos/calibrar/blob/master/R/calibrar-auxiliar.R" class="external-link"><code>R/calibrar-auxiliar.R</code></a></small>
      <div class="d-none name"><code>calibrar_demo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates demo files able to be processed for a full calibration using
the calibrar package</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calibrar_demo</span><span class="op">(</span>path <span class="op">=</span> <span class="cn">NULL</span>, model <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Path to create the demo files</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Model to be used in the demo files, see details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters to be used in the construction of
the demo files.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements:</p>
<dl><dt>path</dt>
<dd><p>Path were the files were saved</p></dd>

<dt>par</dt>
<dd><p>Real value of the parameters used in the demo</p></dd>

<dt>setup</dt>
<dd><p>Path to the calibration setup file</p></dd>

<dt>guess</dt>
<dd><p>Values to be provided as initial guess to the calibrate function</p></dd>

<dt>lower</dt>
<dd><p>Values to be provided as lower bounds to the calibrate function</p></dd>

<dt>upper</dt>
<dd><p>Values to be provided as upper bounds to the calibrate function</p></dd>

<dt>phase</dt>
<dd><p>Values to be provided as phases to the calibrate function</p></dd>

<dt>constants</dt>
<dd><p>Constants used in the demo, any other variable not listed here.</p></dd>

<dt>value</dt>
<dd><p>NA, set for compatibility with summary methods.</p></dd>

<dt>time</dt>
<dd><p>NA, set for compatibility with summary methods.</p></dd>

<dt>counts</dt>
<dd><p>NA, set for compatibility with summary methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Current implemented models are:</p><dl><dt>PoissonMixedModel</dt>
<dd><p>Poisson Autoregressive Mixed model for the dynamics
of a population in different sites:
$$log(\mu_{i, t+1}) = log(\mu_{i, t}) + \alpha + \beta X_{i, t} + \gamma_t$$
where \(\mu_{i, t}\) is the size of the population in site \(i\) at year \(t\),
\(X_{i, t}\) is the value of an environmental variable in site \(i\) at year \(t\).
The parameters to estimate were \(\alpha\), \(\beta\), and \(\gamma_t\), the
random effects for each year, \(\gamma_t \sim N(0,\sigma^2)\), and the initial
population at each site \(\mu_{i, 0}\). We assumed that the observations
\(N_{i,t}\) follow a Poisson distribution with mean \(\mu_{i, t}\).</p></dd>

<dt>PredatorPrey</dt>
<dd><p>Lotka Volterra Predator-Prey model. The model is defined
by a system of ordinary differential equations for the abundance of prey $N$ and predator $P$:
$$\frac{dN}{dt} = rN(1-N/K)-\alpha NP$$
$$\frac{dP}{dt} = -lP + \gamma\alpha NP$$
The parameters to estimate are the prey’s growth rate \(r\), the predator’s
mortality rate \(l\), the carrying capacity of the prey \(K\) and \(\alpha\)
and \(\gamma\) for the predation interaction. Uses <code>deSolve</code> package
for numerical solution of the ODE system.</p></dd>

<dt>SIR</dt>
<dd><p>Susceptible-Infected-Recovered epidemiological model.
The model is defined by a system of ordinary differential equations for the
number of susceptible $S$, infected $I$ and recovered $R$ individuals:
$$\frac{dS}{dt} = -\beta S I/N$$
$$\frac{dI}{dt} = \beta S I/N -\gamma I$$
$$\frac{dR}{dt} = \gamma I$$
The parameters to estimate are the  average number of contacts per person per
time \(\beta\) and the instant probability of an infectious individual
recovering \(\gamma\). Uses <code>deSolve</code> package for numerical solution of the ODE system.</p></dd>

<dt>IBMLotkaVolterra</dt>
<dd><p>Stochastic Individual Based Model for Lotka-Volterra model. Uses <code>ibm</code> package for the simulation.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Oliveros-Ramos and Shin (2014)</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ricardo Oliveros–Ramos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ahr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">880820</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">=</span> <span class="cn">NULL</span> <span class="co"># NULL to use the current directory</span></span></span>
<span class="r-in"><span><span class="co"># create the demonstration files</span></span></span>
<span class="r-in"><span><span class="va">demo</span> <span class="op">=</span> <span class="fu">calibrar_demo</span><span class="op">(</span>path<span class="op">=</span><span class="va">path</span>, model<span class="op">=</span><span class="st">"PredatorPrey"</span>, T<span class="op">=</span><span class="fl">100</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co"># get calibration information</span></span></span>
<span class="r-in"><span><span class="va">calibration_settings</span> <span class="op">=</span> <span class="fu"><a href="calibration_setup.html">calibration_setup</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">demo</span><span class="op">$</span><span class="va">setup</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># get observed data</span></span></span>
<span class="r-in"><span><span class="va">observed</span> <span class="op">=</span> <span class="fu"><a href="calibration_data.html">calibration_data</a></span><span class="op">(</span>setup <span class="op">=</span> <span class="va">calibration_settings</span>, path<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Defining 'run_model' function</span></span></span>
<span class="r-in"><span><span class="va">run_model</span> <span class="op">=</span> <span class="fu">calibrar</span><span class="fu">:::</span><span class="va">.PredatorPreyModel</span></span></span>
<span class="r-in"><span><span class="co"># real parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Real parameters used to simulate data\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="co"># parameters are in a list</span></span></span>
<span class="r-in"><span><span class="co"># objective functions</span></span></span>
<span class="r-in"><span><span class="va">obj</span>  <span class="op">=</span> <span class="fu"><a href="calibration_objFn.html">calibration_objFn</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">run_model</span>, setup<span class="op">=</span><span class="va">calibration_settings</span>, observed<span class="op">=</span><span class="va">observed</span>, T<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj2</span> <span class="op">=</span> <span class="fu"><a href="calibration_objFn.html">calibration_objFn</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">run_model</span>, setup<span class="op">=</span><span class="va">calibration_settings</span>, observed<span class="op">=</span><span class="va">observed</span>, </span></span>
<span class="r-in"><span>T<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="cn">T</span>, aggregate<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Starting calibration...\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running optimization algorithms\n"</span>, <span class="st">"\t"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running optim AHR-ES\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ahr</span> <span class="op">=</span> <span class="fu"><a href="calibrate.html">calibrate</a></span><span class="op">(</span>par<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="va">guess</span>, fn<span class="op">=</span><span class="va">obj</span>, lower<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="va">lower</span>, upper<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="va">upper</span>, phases<span class="op">=</span><span class="va">demo</span><span class="op">$</span><span class="va">phase</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ahr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># } </span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ricardo Oliveros-Ramos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

